# Twitter AI自动运营平台后端接口及实现逻辑

## 1. 用户认证模块

### 后端接口
- `/api/auth/login` - 用户登录
- `/api/auth/logout` - 用户登出
- `/api/auth/send-verification-code` - 发送邮箱验证码
- `/api/auth/verify-code` - 验证邮箱验证码
- `/api/auth/register` - 用户注册
- `/api/auth/reset-password` - 重置密码

### 实现逻辑
- **登录流程**：
  - 验证邮箱和密码
  - 生成JWT令牌，包含用户ID和角色信息
  - 记录登录日志
  - 返回用户信息和令牌

- **登出流程**：
  - 验证当前会话
  - 将令牌加入黑名单或设置过期
  - 清除服务器端会话数据

- **邮箱验证码流程**：
  - 生成随机6位数字验证码
  - 将验证码与邮箱关联并存储到Redis，设置5分钟过期时间
  - 基于不同场景(注册/重置密码)使用不同邮件模板
  - 通过SMTP服务发送验证码邮件
  - 实现频率限制(同一邮箱1分钟内只能请求1次)

- **验证码验证流程**：
  - 从Redis获取存储的验证码
  - 比对用户提交的验证码，允许最多3次错误尝试
  - 验证成功后，生成一个临时验证令牌(verifyToken)
  - 将verifyToken存储到Redis并关联邮箱，设置10分钟过期时间

- **注册流程**：
  - 验证verifyToken的有效性
  - 检查邮箱是否已被注册
  - 对密码进行加密处理(bcrypt/argon2)
  - 创建用户记录并存储到数据库
  - 创建默认用户配置和设置

- **重置密码流程**：
  - 验证verifyToken的有效性
  - 查找对应邮箱的用户账号
  - 对新密码进行加密处理
  - 更新数据库中的密码信息
  - 清除用户的所有现有登录会话

## 2. 分析模块

// ... 以下内容保持不变 